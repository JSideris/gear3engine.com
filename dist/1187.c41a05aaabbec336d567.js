/*! For license information please see 1187.c41a05aaabbec336d567.js.LICENSE.txt */
"use strict";(self.webpackChunkgear3engine_website=self.webpackChunkgear3engine_website||[]).push([[1187],{1187:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=r(2514),o=r(932),i=r(1234),a=r(5868),u=r(8950),s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},s(e,t)};function c(e,t){function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var l=new o.Point,d=function(e){function t(t,r,i){void 0===r&&(r=100),void 0===i&&(i=100);var a=e.call(this,t)||this;return a.tileTransform=new o.Transform,a._width=r,a._height=i,a.uvMatrix=a.texture.uvMatrix||new n.TextureMatrix(t),a.pluginName="tilingSprite",a.uvRespectAnchor=!1,a}return c(t,e),Object.defineProperty(t.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(e){this.tileTransform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(e){this.tileTransform.position.copyFrom(e)},enumerable:!1,configurable:!0}),t.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},t.prototype._render=function(e){var t=this._texture;t&&t.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))},t.prototype._calculateBounds=function(){var e=this._width*-this._anchor._x,t=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),n=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,t,r,n)},t.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new o.Rectangle),t=this._localBoundsRect),this._bounds.getRectangle(t)):e.prototype.getLocalBounds.call(this,t)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,l);var t=this._width,r=this._height,n=-t*this.anchor._x;if(l.x>=n&&l.x<n+t){var o=-r*this.anchor._y;if(l.y>=o&&l.y<o+r)return!0}return!1},t.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.tileTransform=null,this.uvMatrix=null},t.from=function(e,r){return new t(e instanceof n.Texture?e:n.Texture.from(e,r),r.width,r.height)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!1,configurable:!0}),t}(i.Sprite),h="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",p=new o.Matrix,m=function(e){function t(t){var r=e.call(this,t)||this;return t.runners.contextChange.add(r),r.quad=new n.QuadUv,r.state=n.State.for2d(),r}return c(t,e),t.prototype.contextChange=function(){var e=this.renderer,t={globals:e.globalUniforms};this.simpleShader=n.Shader.from(h,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",t),this.shader=e.context.webGLVersion>1?n.Shader.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",t):n.Shader.from(h,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",t)},t.prototype.render=function(e){var t=this.renderer,r=this.quad,n=r.vertices;n[0]=n[6]=e._width*-e.anchor.x,n[1]=n[3]=e._height*-e.anchor.y,n[2]=n[4]=e._width*(1-e.anchor.x),n[5]=n[7]=e._height*(1-e.anchor.y);var o=e.uvRespectAnchor?e.anchor.x:0,i=e.uvRespectAnchor?e.anchor.y:0;(n=r.uvs)[0]=n[6]=-o,n[1]=n[3]=-i,n[2]=n[4]=1-o,n[5]=n[7]=1-i,r.invalidate();var s=e._texture,c=s.baseTexture,l=e.tileTransform.localTransform,d=e.uvMatrix,h=c.isPowerOfTwo&&s.frame.width===c.width&&s.frame.height===c.height;h&&(c._glTextures[t.CONTEXT_UID]?h=c.wrapMode!==a.WRAP_MODES.CLAMP:c.wrapMode===a.WRAP_MODES.CLAMP&&(c.wrapMode=a.WRAP_MODES.REPEAT));var m=h?this.simpleShader:this.shader,f=s.width,v=s.height,_=e._width,x=e._height;p.set(l.a*f/_,l.b*f/x,l.c*v/_,l.d*v/x,l.tx/_,l.ty/x),p.invert(),h?p.prepend(d.mapCoord):(m.uniforms.uMapCoord=d.mapCoord.toArray(!0),m.uniforms.uClampFrame=d.uClampFrame,m.uniforms.uClampOffset=d.uClampOffset),m.uniforms.uTransform=p.toArray(!0),m.uniforms.uColor=u.premultiplyTintToRgba(e.tint,e.worldAlpha,m.uniforms.uColor,c.alphaMode),m.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),m.uniforms.uSampler=s,t.shader.bind(m),t.geometry.bind(r),this.state.blendMode=u.correctBlendMode(e.blendMode,c.alphaMode),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},t}(n.ObjectRenderer);t.TilingSprite=d,t.TilingSpriteRenderer=m}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFZM0MsRUFBT0wsU0FBUzZDLE9BQVE5QixFQUFRa0MsV0FDN0c1QyxFQUFPTCxTQUFTa0Qsa0JBQW9CMUMsRUFBRzNDLFVBQVVVLGVBQWVrRSxTQUFRLEdBQ3hFcEMsRUFBT0wsU0FBU21ELFNBQVdyQyxFQUMzQmxFLEVBQVN5RCxPQUFPK0MsS0FBSy9DLEdBQ3JCekQsRUFBU3lHLFNBQVNELEtBQUt6RCxHQUN2QmpGLEtBQUttRixNQUFNeUQsVUFBWXZKLEVBQU13SixpQkFBaUIvQyxFQUFHOEMsVUFBV3ZDLEVBQVFrQyxXQUNwRXJHLEVBQVNpRCxNQUFNNUQsSUFBSXZCLEtBQUttRixPQUN4QmpELEVBQVN5RyxTQUFTRyxLQUFLOUksS0FBS2tDLFNBQVM2RyxHQUFHQyxVQUFXLEVBQUcsRUFDMUQsRUFDT25FLENBQ1gsQ0EvRnlDLENBK0Z2QzVGLEVBQUtnSyxnQkFFUGxLLEVBQVF1QixhQUFlQSxFQUN2QnZCLEVBQVE4RixxQkFBdUJBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ2VhcjNlbmdpbmUtd2Vic2l0ZS8uLi8uLi9HQU1FUy1TSU1VTEFUT1JTLUZVTi9nZWFyM2VuZ2luZS9wbHVnaW5zL2czZS1jYW52YXMtMmQvbm9kZV9tb2R1bGVzL0BwaXhpL3Nwcml0ZS10aWxpbmcvZGlzdC9janMvc3ByaXRlLXRpbGluZy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEBwaXhpL3Nwcml0ZS10aWxpbmcgLSB2Ni40LjJcbiAqIENvbXBpbGVkIFRodSwgMDIgSnVuIDIwMjIgMTU6Mzk6MjYgVVRDXG4gKlxuICogQHBpeGkvc3ByaXRlLXRpbGluZyBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXG4gKiBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlXG4gKi9cbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcblxudmFyIGNvcmUgPSByZXF1aXJlKCdAcGl4aS9jb3JlJyk7XG52YXIgbWF0aCA9IHJlcXVpcmUoJ0BwaXhpL21hdGgnKTtcbnZhciBzcHJpdGUgPSByZXF1aXJlKCdAcGl4aS9zcHJpdGUnKTtcbnZhciBjb25zdGFudHMgPSByZXF1aXJlKCdAcGl4aS9jb25zdGFudHMnKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ0BwaXhpL3V0aWxzJyk7XG5cbi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSB7IGlmIChiLmhhc093blByb3BlcnR5KHApKSB7IGRbcF0gPSBiW3BdOyB9IH0gfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxuXG52YXIgdGVtcFBvaW50ID0gbmV3IG1hdGguUG9pbnQoKTtcbi8qKlxuICogQSB0aWxpbmcgc3ByaXRlIGlzIGEgZmFzdCB3YXkgb2YgcmVuZGVyaW5nIGEgdGlsaW5nIGltYWdlLlxuICogQG1lbWJlcm9mIFBJWElcbiAqL1xudmFyIFRpbGluZ1Nwcml0ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGlsaW5nU3ByaXRlLCBfc3VwZXIpO1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB0ZXh0dXJlIC0gVGhlIHRleHR1cmUgb2YgdGhlIHRpbGluZyBzcHJpdGUuXG4gICAgICogQHBhcmFtIHdpZHRoIC0gVGhlIHdpZHRoIG9mIHRoZSB0aWxpbmcgc3ByaXRlLlxuICAgICAqIEBwYXJhbSBoZWlnaHQgLSBUaGUgaGVpZ2h0IG9mIHRoZSB0aWxpbmcgc3ByaXRlLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFRpbGluZ1Nwcml0ZSh0ZXh0dXJlLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgIGlmICh3aWR0aCA9PT0gdm9pZCAwKSB7IHdpZHRoID0gMTAwOyB9XG4gICAgICAgIGlmIChoZWlnaHQgPT09IHZvaWQgMCkgeyBoZWlnaHQgPSAxMDA7IH1cbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgdGV4dHVyZSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMudGlsZVRyYW5zZm9ybSA9IG5ldyBtYXRoLlRyYW5zZm9ybSgpO1xuICAgICAgICAvLyBUaGUgd2lkdGggb2YgdGhlIHRpbGluZyBzcHJpdGVcbiAgICAgICAgX3RoaXMuX3dpZHRoID0gd2lkdGg7XG4gICAgICAgIC8vIFRoZSBoZWlnaHQgb2YgdGhlIHRpbGluZyBzcHJpdGVcbiAgICAgICAgX3RoaXMuX2hlaWdodCA9IGhlaWdodDtcbiAgICAgICAgX3RoaXMudXZNYXRyaXggPSBfdGhpcy50ZXh0dXJlLnV2TWF0cml4IHx8IG5ldyBjb3JlLlRleHR1cmVNYXRyaXgodGV4dHVyZSk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQbHVnaW4gdGhhdCBpcyByZXNwb25zaWJsZSBmb3IgcmVuZGVyaW5nIHRoaXMgZWxlbWVudC5cbiAgICAgICAgICogQWxsb3dzIHRvIGN1c3RvbWl6ZSB0aGUgcmVuZGVyaW5nIHByb2Nlc3Mgd2l0aG91dCBvdmVycmlkaW5nICdfcmVuZGVyJyBtZXRob2QuXG4gICAgICAgICAqIEBkZWZhdWx0ICd0aWxpbmdTcHJpdGUnXG4gICAgICAgICAqL1xuICAgICAgICBfdGhpcy5wbHVnaW5OYW1lID0gJ3RpbGluZ1Nwcml0ZSc7XG4gICAgICAgIF90aGlzLnV2UmVzcGVjdEFuY2hvciA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUaWxpbmdTcHJpdGUucHJvdG90eXBlLCBcImNsYW1wTWFyZ2luXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENoYW5nZXMgZnJhbWUgY2xhbXBpbmcgaW4gY29ycmVzcG9uZGluZyB0ZXh0dXJlVHJhbnNmb3JtLCBzaG9ydGN1dFxuICAgICAgICAgKiBDaGFuZ2UgdG8gLTAuNSB0byBhZGQgYSBwaXhlbCB0byB0aGUgZWRnZSwgcmVjb21tZW5kZWQgZm9yIHRyYW5zcGFyZW50IHRyaW1tZWQgdGV4dHVyZXMgaW4gYXRsYXNcbiAgICAgICAgICogQGRlZmF1bHQgMC41XG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudXZNYXRyaXguY2xhbXBNYXJnaW47XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnV2TWF0cml4LmNsYW1wTWFyZ2luID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLnV2TWF0cml4LnVwZGF0ZSh0cnVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUaWxpbmdTcHJpdGUucHJvdG90eXBlLCBcInRpbGVTY2FsZVwiLCB7XG4gICAgICAgIC8qKiBUaGUgc2NhbGluZyBvZiB0aGUgaW1hZ2UgdGhhdCBpcyBiZWluZyB0aWxlZC4gKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50aWxlVHJhbnNmb3JtLnNjYWxlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy50aWxlVHJhbnNmb3JtLnNjYWxlLmNvcHlGcm9tKHZhbHVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUaWxpbmdTcHJpdGUucHJvdG90eXBlLCBcInRpbGVQb3NpdGlvblwiLCB7XG4gICAgICAgIC8qKiBUaGUgb2Zmc2V0IG9mIHRoZSBpbWFnZSB0aGF0IGlzIGJlaW5nIHRpbGVkLiAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRpbGVUcmFuc2Zvcm0ucG9zaXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnRpbGVUcmFuc2Zvcm0ucG9zaXRpb24uY29weUZyb20odmFsdWUpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIFRpbGluZ1Nwcml0ZS5wcm90b3R5cGUuX29uVGV4dHVyZVVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudXZNYXRyaXgpIHtcbiAgICAgICAgICAgIHRoaXMudXZNYXRyaXgudGV4dHVyZSA9IHRoaXMuX3RleHR1cmU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY2FjaGVkVGludCA9IDB4RkZGRkZGO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVuZGVycyB0aGUgb2JqZWN0IHVzaW5nIHRoZSBXZWJHTCByZW5kZXJlclxuICAgICAqIEBwYXJhbSByZW5kZXJlciAtIFRoZSByZW5kZXJlclxuICAgICAqL1xuICAgIFRpbGluZ1Nwcml0ZS5wcm90b3R5cGUuX3JlbmRlciA9IGZ1bmN0aW9uIChyZW5kZXJlcikge1xuICAgICAgICAvLyB0d2VhayBvdXIgdGV4dHVyZSB0ZW1wb3JhcmlseS4uXG4gICAgICAgIHZhciB0ZXh0dXJlID0gdGhpcy5fdGV4dHVyZTtcbiAgICAgICAgaWYgKCF0ZXh0dXJlIHx8ICF0ZXh0dXJlLnZhbGlkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50aWxlVHJhbnNmb3JtLnVwZGF0ZUxvY2FsVHJhbnNmb3JtKCk7XG4gICAgICAgIHRoaXMudXZNYXRyaXgudXBkYXRlKCk7XG4gICAgICAgIHJlbmRlcmVyLmJhdGNoLnNldE9iamVjdFJlbmRlcmVyKHJlbmRlcmVyLnBsdWdpbnNbdGhpcy5wbHVnaW5OYW1lXSk7XG4gICAgICAgIHJlbmRlcmVyLnBsdWdpbnNbdGhpcy5wbHVnaW5OYW1lXS5yZW5kZXIodGhpcyk7XG4gICAgfTtcbiAgICAvKiogVXBkYXRlcyB0aGUgYm91bmRzIG9mIHRoZSB0aWxpbmcgc3ByaXRlLiAqL1xuICAgIFRpbGluZ1Nwcml0ZS5wcm90b3R5cGUuX2NhbGN1bGF0ZUJvdW5kcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1pblggPSB0aGlzLl93aWR0aCAqIC10aGlzLl9hbmNob3IuX3g7XG4gICAgICAgIHZhciBtaW5ZID0gdGhpcy5faGVpZ2h0ICogLXRoaXMuX2FuY2hvci5feTtcbiAgICAgICAgdmFyIG1heFggPSB0aGlzLl93aWR0aCAqICgxIC0gdGhpcy5fYW5jaG9yLl94KTtcbiAgICAgICAgdmFyIG1heFkgPSB0aGlzLl9oZWlnaHQgKiAoMSAtIHRoaXMuX2FuY2hvci5feSk7XG4gICAgICAgIHRoaXMuX2JvdW5kcy5hZGRGcmFtZSh0aGlzLnRyYW5zZm9ybSwgbWluWCwgbWluWSwgbWF4WCwgbWF4WSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBsb2NhbCBib3VuZHMgb2YgdGhlIHNwcml0ZSBvYmplY3QuXG4gICAgICogQHBhcmFtIHJlY3QgLSBPcHRpb25hbCBvdXRwdXQgcmVjdGFuZ2xlLlxuICAgICAqIEByZXR1cm5zIFRoZSBib3VuZHMuXG4gICAgICovXG4gICAgVGlsaW5nU3ByaXRlLnByb3RvdHlwZS5nZXRMb2NhbEJvdW5kcyA9IGZ1bmN0aW9uIChyZWN0KSB7XG4gICAgICAgIC8vIHdlIGNhbiBkbyBhIGZhc3QgbG9jYWwgYm91bmRzIGlmIHRoZSBzcHJpdGUgaGFzIG5vIGNoaWxkcmVuIVxuICAgICAgICBpZiAodGhpcy5jaGlsZHJlbi5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuX2JvdW5kcy5taW5YID0gdGhpcy5fd2lkdGggKiAtdGhpcy5fYW5jaG9yLl94O1xuICAgICAgICAgICAgdGhpcy5fYm91bmRzLm1pblkgPSB0aGlzLl9oZWlnaHQgKiAtdGhpcy5fYW5jaG9yLl95O1xuICAgICAgICAgICAgdGhpcy5fYm91bmRzLm1heFggPSB0aGlzLl93aWR0aCAqICgxIC0gdGhpcy5fYW5jaG9yLl94KTtcbiAgICAgICAgICAgIHRoaXMuX2JvdW5kcy5tYXhZID0gdGhpcy5faGVpZ2h0ICogKDEgLSB0aGlzLl9hbmNob3IuX3kpO1xuICAgICAgICAgICAgaWYgKCFyZWN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9sb2NhbEJvdW5kc1JlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbG9jYWxCb3VuZHNSZWN0ID0gbmV3IG1hdGguUmVjdGFuZ2xlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlY3QgPSB0aGlzLl9sb2NhbEJvdW5kc1JlY3Q7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYm91bmRzLmdldFJlY3RhbmdsZShyZWN0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5nZXRMb2NhbEJvdW5kcy5jYWxsKHRoaXMsIHJlY3QpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGEgcG9pbnQgaXMgaW5zaWRlIHRoaXMgdGlsaW5nIHNwcml0ZS5cbiAgICAgKiBAcGFyYW0gcG9pbnQgLSBUaGUgcG9pbnQgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMgV2hldGhlciBvciBub3QgdGhlIHNwcml0ZSBjb250YWlucyB0aGUgcG9pbnQuXG4gICAgICovXG4gICAgVGlsaW5nU3ByaXRlLnByb3RvdHlwZS5jb250YWluc1BvaW50ID0gZnVuY3Rpb24gKHBvaW50KSB7XG4gICAgICAgIHRoaXMud29ybGRUcmFuc2Zvcm0uYXBwbHlJbnZlcnNlKHBvaW50LCB0ZW1wUG9pbnQpO1xuICAgICAgICB2YXIgd2lkdGggPSB0aGlzLl93aWR0aDtcbiAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuX2hlaWdodDtcbiAgICAgICAgdmFyIHgxID0gLXdpZHRoICogdGhpcy5hbmNob3IuX3g7XG4gICAgICAgIGlmICh0ZW1wUG9pbnQueCA+PSB4MSAmJiB0ZW1wUG9pbnQueCA8IHgxICsgd2lkdGgpIHtcbiAgICAgICAgICAgIHZhciB5MSA9IC1oZWlnaHQgKiB0aGlzLmFuY2hvci5feTtcbiAgICAgICAgICAgIGlmICh0ZW1wUG9pbnQueSA+PSB5MSAmJiB0ZW1wUG9pbnQueSA8IHkxICsgaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRGVzdHJveXMgdGhpcyBzcHJpdGUgYW5kIG9wdGlvbmFsbHkgaXRzIHRleHR1cmUgYW5kIGNoaWxkcmVuXG4gICAgICogQHBhcmFtIHtvYmplY3R8Ym9vbGVhbn0gW29wdGlvbnNdIC0gT3B0aW9ucyBwYXJhbWV0ZXIuIEEgYm9vbGVhbiB3aWxsIGFjdCBhcyBpZiBhbGwgb3B0aW9uc1xuICAgICAqICBoYXZlIGJlZW4gc2V0IHRvIHRoYXQgdmFsdWVcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmNoaWxkcmVuPWZhbHNlXSAtIGlmIHNldCB0byB0cnVlLCBhbGwgdGhlIGNoaWxkcmVuIHdpbGwgaGF2ZSB0aGVpciBkZXN0cm95XG4gICAgICogICAgICBtZXRob2QgY2FsbGVkIGFzIHdlbGwuICdvcHRpb25zJyB3aWxsIGJlIHBhc3NlZCBvbiB0byB0aG9zZSBjYWxscy5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLnRleHR1cmU9ZmFsc2VdIC0gU2hvdWxkIGl0IGRlc3Ryb3kgdGhlIGN1cnJlbnQgdGV4dHVyZSBvZiB0aGUgc3ByaXRlIGFzIHdlbGxcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmJhc2VUZXh0dXJlPWZhbHNlXSAtIFNob3VsZCBpdCBkZXN0cm95IHRoZSBiYXNlIHRleHR1cmUgb2YgdGhlIHNwcml0ZSBhcyB3ZWxsXG4gICAgICovXG4gICAgVGlsaW5nU3ByaXRlLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kZXN0cm95LmNhbGwodGhpcywgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMudGlsZVRyYW5zZm9ybSA9IG51bGw7XG4gICAgICAgIHRoaXMudXZNYXRyaXggPSBudWxsO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogSGVscGVyIGZ1bmN0aW9uIHRoYXQgY3JlYXRlcyBhIG5ldyB0aWxpbmcgc3ByaXRlIGJhc2VkIG9uIHRoZSBzb3VyY2UgeW91IHByb3ZpZGUuXG4gICAgICogVGhlIHNvdXJjZSBjYW4gYmUgLSBmcmFtZSBpZCwgaW1hZ2UgdXJsLCB2aWRlbyB1cmwsIGNhbnZhcyBlbGVtZW50LCB2aWRlbyBlbGVtZW50LCBiYXNlIHRleHR1cmVcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd8UElYSS5UZXh0dXJlfEhUTUxDYW52YXNFbGVtZW50fEhUTUxWaWRlb0VsZW1lbnR9IHNvdXJjZSAtIFNvdXJjZSB0byBjcmVhdGUgdGV4dHVyZSBmcm9tXG4gICAgICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnMgLSBTZWUge0BsaW5rIFBJWEkuQmFzZVRleHR1cmV9J3MgY29uc3RydWN0b3IgZm9yIG9wdGlvbnMuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG9wdGlvbnMud2lkdGggLSByZXF1aXJlZCB3aWR0aCBvZiB0aGUgdGlsaW5nIHNwcml0ZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvcHRpb25zLmhlaWdodCAtIHJlcXVpcmVkIGhlaWdodCBvZiB0aGUgdGlsaW5nIHNwcml0ZVxuICAgICAqIEByZXR1cm5zIHtQSVhJLlRpbGluZ1Nwcml0ZX0gVGhlIG5ld2x5IGNyZWF0ZWQgdGV4dHVyZVxuICAgICAqL1xuICAgIFRpbGluZ1Nwcml0ZS5mcm9tID0gZnVuY3Rpb24gKHNvdXJjZSwgb3B0aW9ucykge1xuICAgICAgICB2YXIgdGV4dHVyZSA9IChzb3VyY2UgaW5zdGFuY2VvZiBjb3JlLlRleHR1cmUpXG4gICAgICAgICAgICA/IHNvdXJjZVxuICAgICAgICAgICAgOiBjb3JlLlRleHR1cmUuZnJvbShzb3VyY2UsIG9wdGlvbnMpO1xuICAgICAgICByZXR1cm4gbmV3IFRpbGluZ1Nwcml0ZSh0ZXh0dXJlLCBvcHRpb25zLndpZHRoLCBvcHRpb25zLmhlaWdodCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGlsaW5nU3ByaXRlLnByb3RvdHlwZSwgXCJ3aWR0aFwiLCB7XG4gICAgICAgIC8qKiBUaGUgd2lkdGggb2YgdGhlIHNwcml0ZSwgc2V0dGluZyB0aGlzIHdpbGwgYWN0dWFsbHkgbW9kaWZ5IHRoZSBzY2FsZSB0byBhY2hpZXZlIHRoZSB2YWx1ZSBzZXQuICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dpZHRoO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fd2lkdGggPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUaWxpbmdTcHJpdGUucHJvdG90eXBlLCBcImhlaWdodFwiLCB7XG4gICAgICAgIC8qKiBUaGUgaGVpZ2h0IG9mIHRoZSBUaWxpbmdTcHJpdGUsIHNldHRpbmcgdGhpcyB3aWxsIGFjdHVhbGx5IG1vZGlmeSB0aGUgc2NhbGUgdG8gYWNoaWV2ZSB0aGUgdmFsdWUgc2V0LiAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9oZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9oZWlnaHQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBUaWxpbmdTcHJpdGU7XG59KHNwcml0ZS5TcHJpdGUpKTtcblxudmFyIGZyYWdtZW50U2ltcGxlU3JjID0gXCIjdmVyc2lvbiAxMDBcXG4jZGVmaW5lIFNIQURFUl9OQU1FIFRpbGluZy1TcHJpdGUtU2ltcGxlLTEwMFxcblxcbnByZWNpc2lvbiBsb3dwIGZsb2F0O1xcblxcbnZhcnlpbmcgdmVjMiB2VGV4dHVyZUNvb3JkO1xcblxcbnVuaWZvcm0gc2FtcGxlcjJEIHVTYW1wbGVyO1xcbnVuaWZvcm0gdmVjNCB1Q29sb3I7XFxuXFxudm9pZCBtYWluKHZvaWQpXFxue1xcbiAgICB2ZWM0IHRleFNhbXBsZSA9IHRleHR1cmUyRCh1U2FtcGxlciwgdlRleHR1cmVDb29yZCk7XFxuICAgIGdsX0ZyYWdDb2xvciA9IHRleFNhbXBsZSAqIHVDb2xvcjtcXG59XFxuXCI7XG5cbnZhciBnbDFWZXJ0ZXhTcmMgPSBcIiN2ZXJzaW9uIDEwMFxcbiNkZWZpbmUgU0hBREVSX05BTUUgVGlsaW5nLVNwcml0ZS0xMDBcXG5cXG5wcmVjaXNpb24gbG93cCBmbG9hdDtcXG5cXG5hdHRyaWJ1dGUgdmVjMiBhVmVydGV4UG9zaXRpb247XFxuYXR0cmlidXRlIHZlYzIgYVRleHR1cmVDb29yZDtcXG5cXG51bmlmb3JtIG1hdDMgcHJvamVjdGlvbk1hdHJpeDtcXG51bmlmb3JtIG1hdDMgdHJhbnNsYXRpb25NYXRyaXg7XFxudW5pZm9ybSBtYXQzIHVUcmFuc2Zvcm07XFxuXFxudmFyeWluZyB2ZWMyIHZUZXh0dXJlQ29vcmQ7XFxuXFxudm9pZCBtYWluKHZvaWQpXFxue1xcbiAgICBnbF9Qb3NpdGlvbiA9IHZlYzQoKHByb2plY3Rpb25NYXRyaXggKiB0cmFuc2xhdGlvbk1hdHJpeCAqIHZlYzMoYVZlcnRleFBvc2l0aW9uLCAxLjApKS54eSwgMC4wLCAxLjApO1xcblxcbiAgICB2VGV4dHVyZUNvb3JkID0gKHVUcmFuc2Zvcm0gKiB2ZWMzKGFUZXh0dXJlQ29vcmQsIDEuMCkpLnh5O1xcbn1cXG5cIjtcblxudmFyIGdsMUZyYWdtZW50U3JjID0gXCIjdmVyc2lvbiAxMDBcXG4jaWZkZWYgR0xfRVhUX3NoYWRlcl90ZXh0dXJlX2xvZFxcbiAgICAjZXh0ZW5zaW9uIEdMX0VYVF9zaGFkZXJfdGV4dHVyZV9sb2QgOiBlbmFibGVcXG4jZW5kaWZcXG4jZGVmaW5lIFNIQURFUl9OQU1FIFRpbGluZy1TcHJpdGUtMTAwXFxuXFxucHJlY2lzaW9uIGxvd3AgZmxvYXQ7XFxuXFxudmFyeWluZyB2ZWMyIHZUZXh0dXJlQ29vcmQ7XFxuXFxudW5pZm9ybSBzYW1wbGVyMkQgdVNhbXBsZXI7XFxudW5pZm9ybSB2ZWM0IHVDb2xvcjtcXG51bmlmb3JtIG1hdDMgdU1hcENvb3JkO1xcbnVuaWZvcm0gdmVjNCB1Q2xhbXBGcmFtZTtcXG51bmlmb3JtIHZlYzIgdUNsYW1wT2Zmc2V0O1xcblxcbnZvaWQgbWFpbih2b2lkKVxcbntcXG4gICAgdmVjMiBjb29yZCA9IHZUZXh0dXJlQ29vcmQgKyBjZWlsKHVDbGFtcE9mZnNldCAtIHZUZXh0dXJlQ29vcmQpO1xcbiAgICBjb29yZCA9ICh1TWFwQ29vcmQgKiB2ZWMzKGNvb3JkLCAxLjApKS54eTtcXG4gICAgdmVjMiB1bmNsYW1wZWQgPSBjb29yZDtcXG4gICAgY29vcmQgPSBjbGFtcChjb29yZCwgdUNsYW1wRnJhbWUueHksIHVDbGFtcEZyYW1lLnp3KTtcXG5cXG4gICAgI2lmZGVmIEdMX0VYVF9zaGFkZXJfdGV4dHVyZV9sb2RcXG4gICAgICAgIHZlYzQgdGV4U2FtcGxlID0gdW5jbGFtcGVkID09IGNvb3JkXFxuICAgICAgICAgICAgPyB0ZXh0dXJlMkQodVNhbXBsZXIsIGNvb3JkKSBcXG4gICAgICAgICAgICA6IHRleHR1cmUyRExvZEVYVCh1U2FtcGxlciwgY29vcmQsIDApO1xcbiAgICAjZWxzZVxcbiAgICAgICAgdmVjNCB0ZXhTYW1wbGUgPSB0ZXh0dXJlMkQodVNhbXBsZXIsIGNvb3JkKTtcXG4gICAgI2VuZGlmXFxuXFxuICAgIGdsX0ZyYWdDb2xvciA9IHRleFNhbXBsZSAqIHVDb2xvcjtcXG59XFxuXCI7XG5cbnZhciBnbDJWZXJ0ZXhTcmMgPSBcIiN2ZXJzaW9uIDMwMCBlc1xcbiNkZWZpbmUgU0hBREVSX05BTUUgVGlsaW5nLVNwcml0ZS0zMDBcXG5cXG5wcmVjaXNpb24gbG93cCBmbG9hdDtcXG5cXG5pbiB2ZWMyIGFWZXJ0ZXhQb3NpdGlvbjtcXG5pbiB2ZWMyIGFUZXh0dXJlQ29vcmQ7XFxuXFxudW5pZm9ybSBtYXQzIHByb2plY3Rpb25NYXRyaXg7XFxudW5pZm9ybSBtYXQzIHRyYW5zbGF0aW9uTWF0cml4O1xcbnVuaWZvcm0gbWF0MyB1VHJhbnNmb3JtO1xcblxcbm91dCB2ZWMyIHZUZXh0dXJlQ29vcmQ7XFxuXFxudm9pZCBtYWluKHZvaWQpXFxue1xcbiAgICBnbF9Qb3NpdGlvbiA9IHZlYzQoKHByb2plY3Rpb25NYXRyaXggKiB0cmFuc2xhdGlvbk1hdHJpeCAqIHZlYzMoYVZlcnRleFBvc2l0aW9uLCAxLjApKS54eSwgMC4wLCAxLjApO1xcblxcbiAgICB2VGV4dHVyZUNvb3JkID0gKHVUcmFuc2Zvcm0gKiB2ZWMzKGFUZXh0dXJlQ29vcmQsIDEuMCkpLnh5O1xcbn1cXG5cIjtcblxudmFyIGdsMkZyYWdtZW50U3JjID0gXCIjdmVyc2lvbiAzMDAgZXNcXG4jZGVmaW5lIFNIQURFUl9OQU1FIFRpbGluZy1TcHJpdGUtMTAwXFxuXFxucHJlY2lzaW9uIGxvd3AgZmxvYXQ7XFxuXFxuaW4gdmVjMiB2VGV4dHVyZUNvb3JkO1xcblxcbm91dCB2ZWM0IGZyYWdtZW50Q29sb3I7XFxuXFxudW5pZm9ybSBzYW1wbGVyMkQgdVNhbXBsZXI7XFxudW5pZm9ybSB2ZWM0IHVDb2xvcjtcXG51bmlmb3JtIG1hdDMgdU1hcENvb3JkO1xcbnVuaWZvcm0gdmVjNCB1Q2xhbXBGcmFtZTtcXG51bmlmb3JtIHZlYzIgdUNsYW1wT2Zmc2V0O1xcblxcbnZvaWQgbWFpbih2b2lkKVxcbntcXG4gICAgdmVjMiBjb29yZCA9IHZUZXh0dXJlQ29vcmQgKyBjZWlsKHVDbGFtcE9mZnNldCAtIHZUZXh0dXJlQ29vcmQpO1xcbiAgICBjb29yZCA9ICh1TWFwQ29vcmQgKiB2ZWMzKGNvb3JkLCAxLjApKS54eTtcXG4gICAgdmVjMiB1bmNsYW1wZWQgPSBjb29yZDtcXG4gICAgY29vcmQgPSBjbGFtcChjb29yZCwgdUNsYW1wRnJhbWUueHksIHVDbGFtcEZyYW1lLnp3KTtcXG5cXG4gICAgdmVjNCB0ZXhTYW1wbGUgPSB0ZXh0dXJlKHVTYW1wbGVyLCBjb29yZCwgdW5jbGFtcGVkID09IGNvb3JkID8gMC4wZiA6IC0zMi4wZik7Ly8gbG9kLWJpYXMgdmVyeSBuZWdhdGl2ZSB0byBmb3JjZSBsb2QgMFxcblxcbiAgICBmcmFnbWVudENvbG9yID0gdGV4U2FtcGxlICogdUNvbG9yO1xcbn1cXG5cIjtcblxudmFyIHRlbXBNYXQgPSBuZXcgbWF0aC5NYXRyaXgoKTtcbi8qKlxuICogV2ViR0wgcmVuZGVyZXIgcGx1Z2luIGZvciB0aWxpbmcgc3ByaXRlc1xuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQGV4dGVuZHMgUElYSS5PYmplY3RSZW5kZXJlclxuICovXG52YXIgVGlsaW5nU3ByaXRlUmVuZGVyZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRpbGluZ1Nwcml0ZVJlbmRlcmVyLCBfc3VwZXIpO1xuICAgIC8qKlxuICAgICAqIGNvbnN0cnVjdG9yIGZvciByZW5kZXJlclxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBUaGUgcmVuZGVyZXIgdGhpcyB0aWxpbmcgYXdlc29tZW5lc3Mgd29ya3MgZm9yLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFRpbGluZ1Nwcml0ZVJlbmRlcmVyKHJlbmRlcmVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHJlbmRlcmVyKSB8fCB0aGlzO1xuICAgICAgICAvLyBXZWJHTCB2ZXJzaW9uIGlzIG5vdCBhdmFpbGFibGUgZHVyaW5nIGluaXRpYWxpemF0aW9uIVxuICAgICAgICByZW5kZXJlci5ydW5uZXJzLmNvbnRleHRDaGFuZ2UuYWRkKF90aGlzKTtcbiAgICAgICAgX3RoaXMucXVhZCA9IG5ldyBjb3JlLlF1YWRVdigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIFdlYkdMIHN0YXRlIGluIHdoaWNoIHRoaXMgcmVuZGVyZXIgd2lsbCB3b3JrLlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlN0YXRlfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIF90aGlzLnN0YXRlID0gY29yZS5TdGF0ZS5mb3IyZCgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIC8qKiBDcmVhdGVzIHNoYWRlcnMgd2hlbiBjb250ZXh0IGlzIGluaXRpYWxpemVkLiAqL1xuICAgIFRpbGluZ1Nwcml0ZVJlbmRlcmVyLnByb3RvdHlwZS5jb250ZXh0Q2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVuZGVyZXIgPSB0aGlzLnJlbmRlcmVyO1xuICAgICAgICB2YXIgdW5pZm9ybXMgPSB7IGdsb2JhbHM6IHJlbmRlcmVyLmdsb2JhbFVuaWZvcm1zIH07XG4gICAgICAgIHRoaXMuc2ltcGxlU2hhZGVyID0gY29yZS5TaGFkZXIuZnJvbShnbDFWZXJ0ZXhTcmMsIGZyYWdtZW50U2ltcGxlU3JjLCB1bmlmb3Jtcyk7XG4gICAgICAgIHRoaXMuc2hhZGVyID0gcmVuZGVyZXIuY29udGV4dC53ZWJHTFZlcnNpb24gPiAxXG4gICAgICAgICAgICA/IGNvcmUuU2hhZGVyLmZyb20oZ2wyVmVydGV4U3JjLCBnbDJGcmFnbWVudFNyYywgdW5pZm9ybXMpXG4gICAgICAgICAgICA6IGNvcmUuU2hhZGVyLmZyb20oZ2wxVmVydGV4U3JjLCBnbDFGcmFnbWVudFNyYywgdW5pZm9ybXMpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtQSVhJLlRpbGluZ1Nwcml0ZX0gdHMgLSB0aWxpbmdTcHJpdGUgdG8gYmUgcmVuZGVyZWRcbiAgICAgKi9cbiAgICBUaWxpbmdTcHJpdGVSZW5kZXJlci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKHRzKSB7XG4gICAgICAgIHZhciByZW5kZXJlciA9IHRoaXMucmVuZGVyZXI7XG4gICAgICAgIHZhciBxdWFkID0gdGhpcy5xdWFkO1xuICAgICAgICB2YXIgdmVydGljZXMgPSBxdWFkLnZlcnRpY2VzO1xuICAgICAgICB2ZXJ0aWNlc1swXSA9IHZlcnRpY2VzWzZdID0gKHRzLl93aWR0aCkgKiAtdHMuYW5jaG9yLng7XG4gICAgICAgIHZlcnRpY2VzWzFdID0gdmVydGljZXNbM10gPSB0cy5faGVpZ2h0ICogLXRzLmFuY2hvci55O1xuICAgICAgICB2ZXJ0aWNlc1syXSA9IHZlcnRpY2VzWzRdID0gKHRzLl93aWR0aCkgKiAoMS4wIC0gdHMuYW5jaG9yLngpO1xuICAgICAgICB2ZXJ0aWNlc1s1XSA9IHZlcnRpY2VzWzddID0gdHMuX2hlaWdodCAqICgxLjAgLSB0cy5hbmNob3IueSk7XG4gICAgICAgIHZhciBhbmNob3JYID0gdHMudXZSZXNwZWN0QW5jaG9yID8gdHMuYW5jaG9yLnggOiAwO1xuICAgICAgICB2YXIgYW5jaG9yWSA9IHRzLnV2UmVzcGVjdEFuY2hvciA/IHRzLmFuY2hvci55IDogMDtcbiAgICAgICAgdmVydGljZXMgPSBxdWFkLnV2cztcbiAgICAgICAgdmVydGljZXNbMF0gPSB2ZXJ0aWNlc1s2XSA9IC1hbmNob3JYO1xuICAgICAgICB2ZXJ0aWNlc1sxXSA9IHZlcnRpY2VzWzNdID0gLWFuY2hvclk7XG4gICAgICAgIHZlcnRpY2VzWzJdID0gdmVydGljZXNbNF0gPSAxLjAgLSBhbmNob3JYO1xuICAgICAgICB2ZXJ0aWNlc1s1XSA9IHZlcnRpY2VzWzddID0gMS4wIC0gYW5jaG9yWTtcbiAgICAgICAgcXVhZC5pbnZhbGlkYXRlKCk7XG4gICAgICAgIHZhciB0ZXggPSB0cy5fdGV4dHVyZTtcbiAgICAgICAgdmFyIGJhc2VUZXggPSB0ZXguYmFzZVRleHR1cmU7XG4gICAgICAgIHZhciBsdCA9IHRzLnRpbGVUcmFuc2Zvcm0ubG9jYWxUcmFuc2Zvcm07XG4gICAgICAgIHZhciB1diA9IHRzLnV2TWF0cml4O1xuICAgICAgICB2YXIgaXNTaW1wbGUgPSBiYXNlVGV4LmlzUG93ZXJPZlR3b1xuICAgICAgICAgICAgJiYgdGV4LmZyYW1lLndpZHRoID09PSBiYXNlVGV4LndpZHRoICYmIHRleC5mcmFtZS5oZWlnaHQgPT09IGJhc2VUZXguaGVpZ2h0O1xuICAgICAgICAvLyBhdXRvLCBmb3JjZSByZXBlYXQgd3JhcE1vZGUgZm9yIGJpZyB0aWxpbmcgdGV4dHVyZXNcbiAgICAgICAgaWYgKGlzU2ltcGxlKSB7XG4gICAgICAgICAgICBpZiAoIWJhc2VUZXguX2dsVGV4dHVyZXNbcmVuZGVyZXIuQ09OVEVYVF9VSURdKSB7XG4gICAgICAgICAgICAgICAgaWYgKGJhc2VUZXgud3JhcE1vZGUgPT09IGNvbnN0YW50cy5XUkFQX01PREVTLkNMQU1QKSB7XG4gICAgICAgICAgICAgICAgICAgIGJhc2VUZXgud3JhcE1vZGUgPSBjb25zdGFudHMuV1JBUF9NT0RFUy5SRVBFQVQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaXNTaW1wbGUgPSBiYXNlVGV4LndyYXBNb2RlICE9PSBjb25zdGFudHMuV1JBUF9NT0RFUy5DTEFNUDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgc2hhZGVyID0gaXNTaW1wbGUgPyB0aGlzLnNpbXBsZVNoYWRlciA6IHRoaXMuc2hhZGVyO1xuICAgICAgICB2YXIgdyA9IHRleC53aWR0aDtcbiAgICAgICAgdmFyIGggPSB0ZXguaGVpZ2h0O1xuICAgICAgICB2YXIgVyA9IHRzLl93aWR0aDtcbiAgICAgICAgdmFyIEggPSB0cy5faGVpZ2h0O1xuICAgICAgICB0ZW1wTWF0LnNldChsdC5hICogdyAvIFcsIGx0LmIgKiB3IC8gSCwgbHQuYyAqIGggLyBXLCBsdC5kICogaCAvIEgsIGx0LnR4IC8gVywgbHQudHkgLyBIKTtcbiAgICAgICAgLy8gdGhhdCBwYXJ0IGlzIHRoZSBzYW1lIGFzIGFib3ZlOlxuICAgICAgICAvLyB0ZW1wTWF0LmlkZW50aXR5KCk7XG4gICAgICAgIC8vIHRlbXBNYXQuc2NhbGUodGV4LndpZHRoLCB0ZXguaGVpZ2h0KTtcbiAgICAgICAgLy8gdGVtcE1hdC5wcmVwZW5kKGx0KTtcbiAgICAgICAgLy8gdGVtcE1hdC5zY2FsZSgxLjAgLyB0cy5fd2lkdGgsIDEuMCAvIHRzLl9oZWlnaHQpO1xuICAgICAgICB0ZW1wTWF0LmludmVydCgpO1xuICAgICAgICBpZiAoaXNTaW1wbGUpIHtcbiAgICAgICAgICAgIHRlbXBNYXQucHJlcGVuZCh1di5tYXBDb29yZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzaGFkZXIudW5pZm9ybXMudU1hcENvb3JkID0gdXYubWFwQ29vcmQudG9BcnJheSh0cnVlKTtcbiAgICAgICAgICAgIHNoYWRlci51bmlmb3Jtcy51Q2xhbXBGcmFtZSA9IHV2LnVDbGFtcEZyYW1lO1xuICAgICAgICAgICAgc2hhZGVyLnVuaWZvcm1zLnVDbGFtcE9mZnNldCA9IHV2LnVDbGFtcE9mZnNldDtcbiAgICAgICAgfVxuICAgICAgICBzaGFkZXIudW5pZm9ybXMudVRyYW5zZm9ybSA9IHRlbXBNYXQudG9BcnJheSh0cnVlKTtcbiAgICAgICAgc2hhZGVyLnVuaWZvcm1zLnVDb2xvciA9IHV0aWxzLnByZW11bHRpcGx5VGludFRvUmdiYSh0cy50aW50LCB0cy53b3JsZEFscGhhLCBzaGFkZXIudW5pZm9ybXMudUNvbG9yLCBiYXNlVGV4LmFscGhhTW9kZSk7XG4gICAgICAgIHNoYWRlci51bmlmb3Jtcy50cmFuc2xhdGlvbk1hdHJpeCA9IHRzLnRyYW5zZm9ybS53b3JsZFRyYW5zZm9ybS50b0FycmF5KHRydWUpO1xuICAgICAgICBzaGFkZXIudW5pZm9ybXMudVNhbXBsZXIgPSB0ZXg7XG4gICAgICAgIHJlbmRlcmVyLnNoYWRlci5iaW5kKHNoYWRlcik7XG4gICAgICAgIHJlbmRlcmVyLmdlb21ldHJ5LmJpbmQocXVhZCk7XG4gICAgICAgIHRoaXMuc3RhdGUuYmxlbmRNb2RlID0gdXRpbHMuY29ycmVjdEJsZW5kTW9kZSh0cy5ibGVuZE1vZGUsIGJhc2VUZXguYWxwaGFNb2RlKTtcbiAgICAgICAgcmVuZGVyZXIuc3RhdGUuc2V0KHRoaXMuc3RhdGUpO1xuICAgICAgICByZW5kZXJlci5nZW9tZXRyeS5kcmF3KHRoaXMucmVuZGVyZXIuZ2wuVFJJQU5HTEVTLCA2LCAwKTtcbiAgICB9O1xuICAgIHJldHVybiBUaWxpbmdTcHJpdGVSZW5kZXJlcjtcbn0oY29yZS5PYmplY3RSZW5kZXJlcikpO1xuXG5leHBvcnRzLlRpbGluZ1Nwcml0ZSA9IFRpbGluZ1Nwcml0ZTtcbmV4cG9ydHMuVGlsaW5nU3ByaXRlUmVuZGVyZXIgPSBUaWxpbmdTcHJpdGVSZW5kZXJlcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNwcml0ZS10aWxpbmcuanMubWFwXG4iXSwibmFtZXMiOlsiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJjb3JlIiwibWF0aCIsInNwcml0ZSIsImNvbnN0YW50cyIsInV0aWxzIiwiZXh0ZW5kU3RhdGljcyIsImQiLCJiIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJBcnJheSIsInAiLCJoYXNPd25Qcm9wZXJ0eSIsIl9fZXh0ZW5kcyIsIl9fIiwidGhpcyIsImNvbnN0cnVjdG9yIiwicHJvdG90eXBlIiwiY3JlYXRlIiwidGVtcFBvaW50IiwiUG9pbnQiLCJUaWxpbmdTcHJpdGUiLCJfc3VwZXIiLCJ0ZXh0dXJlIiwid2lkdGgiLCJoZWlnaHQiLCJfdGhpcyIsImNhbGwiLCJ0aWxlVHJhbnNmb3JtIiwiVHJhbnNmb3JtIiwiX3dpZHRoIiwiX2hlaWdodCIsInV2TWF0cml4IiwiVGV4dHVyZU1hdHJpeCIsInBsdWdpbk5hbWUiLCJ1dlJlc3BlY3RBbmNob3IiLCJnZXQiLCJjbGFtcE1hcmdpbiIsInNldCIsInVwZGF0ZSIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJzY2FsZSIsImNvcHlGcm9tIiwicG9zaXRpb24iLCJfb25UZXh0dXJlVXBkYXRlIiwiX3RleHR1cmUiLCJfY2FjaGVkVGludCIsIl9yZW5kZXIiLCJyZW5kZXJlciIsInZhbGlkIiwidXBkYXRlTG9jYWxUcmFuc2Zvcm0iLCJiYXRjaCIsInNldE9iamVjdFJlbmRlcmVyIiwicGx1Z2lucyIsInJlbmRlciIsIl9jYWxjdWxhdGVCb3VuZHMiLCJtaW5YIiwiX2FuY2hvciIsIl94IiwibWluWSIsIl95IiwibWF4WCIsIm1heFkiLCJfYm91bmRzIiwiYWRkRnJhbWUiLCJ0cmFuc2Zvcm0iLCJnZXRMb2NhbEJvdW5kcyIsInJlY3QiLCJjaGlsZHJlbiIsImxlbmd0aCIsIl9sb2NhbEJvdW5kc1JlY3QiLCJSZWN0YW5nbGUiLCJnZXRSZWN0YW5nbGUiLCJjb250YWluc1BvaW50IiwicG9pbnQiLCJ3b3JsZFRyYW5zZm9ybSIsImFwcGx5SW52ZXJzZSIsIngxIiwiYW5jaG9yIiwieCIsInkxIiwieSIsImRlc3Ryb3kiLCJvcHRpb25zIiwiZnJvbSIsInNvdXJjZSIsIlRleHR1cmUiLCJTcHJpdGUiLCJnbDFWZXJ0ZXhTcmMiLCJ0ZW1wTWF0IiwiTWF0cml4IiwiVGlsaW5nU3ByaXRlUmVuZGVyZXIiLCJydW5uZXJzIiwiY29udGV4dENoYW5nZSIsImFkZCIsInF1YWQiLCJRdWFkVXYiLCJzdGF0ZSIsIlN0YXRlIiwiZm9yMmQiLCJ1bmlmb3JtcyIsImdsb2JhbHMiLCJnbG9iYWxVbmlmb3JtcyIsInNpbXBsZVNoYWRlciIsIlNoYWRlciIsInNoYWRlciIsImNvbnRleHQiLCJ3ZWJHTFZlcnNpb24iLCJ0cyIsInZlcnRpY2VzIiwiYW5jaG9yWCIsImFuY2hvclkiLCJ1dnMiLCJpbnZhbGlkYXRlIiwidGV4IiwiYmFzZVRleCIsImJhc2VUZXh0dXJlIiwibHQiLCJsb2NhbFRyYW5zZm9ybSIsInV2IiwiaXNTaW1wbGUiLCJpc1Bvd2VyT2ZUd28iLCJmcmFtZSIsIl9nbFRleHR1cmVzIiwiQ09OVEVYVF9VSUQiLCJ3cmFwTW9kZSIsIldSQVBfTU9ERVMiLCJDTEFNUCIsIlJFUEVBVCIsInciLCJoIiwiVyIsIkgiLCJhIiwiYyIsInR4IiwidHkiLCJpbnZlcnQiLCJwcmVwZW5kIiwibWFwQ29vcmQiLCJ1TWFwQ29vcmQiLCJ0b0FycmF5IiwidUNsYW1wRnJhbWUiLCJ1Q2xhbXBPZmZzZXQiLCJ1VHJhbnNmb3JtIiwidUNvbG9yIiwicHJlbXVsdGlwbHlUaW50VG9SZ2JhIiwidGludCIsIndvcmxkQWxwaGEiLCJhbHBoYU1vZGUiLCJ0cmFuc2xhdGlvbk1hdHJpeCIsInVTYW1wbGVyIiwiYmluZCIsImdlb21ldHJ5IiwiYmxlbmRNb2RlIiwiY29ycmVjdEJsZW5kTW9kZSIsImRyYXciLCJnbCIsIlRSSUFOR0xFUyIsIk9iamVjdFJlbmRlcmVyIl0sInNvdXJjZVJvb3QiOiIifQ==